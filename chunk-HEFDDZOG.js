import{a as g,b as z}from"./chunk-XXJRU3GS.js";import"./chunk-DJJM56ZO.js";import{a as W}from"./chunk-4K64L5XJ.js";import{a as X,b as Z}from"./chunk-SBTZUPCH.js";import"./chunk-LBSZLZCM.js";import"./chunk-XK52KKFL.js";import{a as ee}from"./chunk-IR2VG2X3.js";import"./chunk-ZTQ5H4AK.js";import{a as Y}from"./chunk-XM5TMCIA.js";import"./chunk-3RCH7TOZ.js";import"./chunk-WIAGADDS.js";import"./chunk-5BCV2XAA.js";import"./chunk-HWCJOYN3.js";import"./chunk-4BGRGWBP.js";import"./chunk-5T6JT7FG.js";import"./chunk-RHRTBMBA.js";import"./chunk-DYAATRFR.js";import"./chunk-GLL3PL4Q.js";import"./chunk-QEWZLHID.js";import"./chunk-PD5FG3A7.js";import"./chunk-7JQJEV7G.js";import"./chunk-2K3GEZZY.js";import"./chunk-7A5ZJ3YN.js";import"./chunk-2A7PSW7O.js";import"./chunk-VO65IASJ.js";import"./chunk-GLYGKSTO.js";import{b as K,c as q}from"./chunk-PIL2IJC4.js";import"./chunk-OOBQPUIX.js";import{a as J}from"./chunk-OM3WRHFD.js";import{b as R}from"./chunk-VYOS5CGL.js";import"./chunk-RZQ3UNDK.js";import"./chunk-DKARO4CX.js";import"./chunk-DHAI4KFY.js";import"./chunk-5MLMU7SK.js";import{b as U}from"./chunk-GEWE6M22.js";import"./chunk-SJRCRC22.js";import{a as H}from"./chunk-X3TMHFY3.js";import"./chunk-EE6A4D3O.js";import"./chunk-2CFRUPNI.js";import{a as j}from"./chunk-F6RS7OIB.js";import"./chunk-KW5235UB.js";import{b as Q}from"./chunk-7JOAVXDE.js";import"./chunk-7SDYZQX7.js";import"./chunk-KUYOE2KN.js";import"./chunk-AJOFB37Q.js";import{$b as h,Ea as F,Gc as w,Hc as I,Ib as s,Kb as N,Ob as f,Qb as P,Rb as k,Sb as $,Tb as p,U as T,Ub as a,Vb as d,Vc as C,Zb as A,ac as c,db as o,ea as E,ec as B,k as b,lb as S,ld as M,ma as u,na as x,nc as O,oc as L,pc as v,rc as _,sb as D,tc as y,v as G,wb as V,yb as m}from"./chunk-GYX7HZX3.js";import"./chunk-4CLCTAJ7.js";function ie(t,r){if(t&1&&d(0,"app-offering",4),t&2){let e=r.$implicit;s("details",e)}}function ne(t,r){if(t&1&&(p(0,"app-item-card-switch",1),m(1,ie,1,1,"ng-template",3),a()),t&2){let e=c();s("item",e.selectedEntity)}}function oe(t,r){if(t&1&&d(0,"app-ui-icon",13),t&2){let e=c(2).$implicit,i=c(2);B("matTooltip","",e.npc==null?null:e.npc.characterName," is dateable"),s("uiIcon",i.uiIcon.LOVE)}}function ae(t,r){if(t&1&&(p(0,"div",14),d(1,"app-ui-icon",15),_(2),w(3,"ingameDate"),a()),t&2){let e=c(2).$implicit,i=c(2);o(),s("uiIcon",i.uiIcon.BIRTHDAY),o(),y(" ",I(3,2,e.npc.birthday)," ")}}function re(t,r){if(t&1&&(d(0,"app-item-icon",10),p(1,"div",11)(2,"div",12),_(3),m(4,oe,1,3,"app-ui-icon",13),a(),m(5,ae,4,4,"div",14),a()),t&2){let e=c().$implicit;s("itemName",e.preferences.npc.iconName),o(3),y(" ",e.preferences.npc.characterName," "),o(),f(e.npc!=null&&e.npc.isDateable?4:-1),o(),f(e.npc&&e.npc.birthday?5:-1)}}function pe(t,r){t&1&&_(0," Universal ")}function ce(t,r){if(t&1){let e=A();p(0,"app-expandable",5,0)(2,"div",6),h("click",function(){u(e);let n=v(1);return x(n.toggle())}),p(3,"div",7),m(4,re,6,4)(5,pe,1,0),a(),d(6,"i",8),a(),p(7,"app-gifting-grid",9),h("itemClicked",function(n){u(e);let l=c(2);return x(l.showDetails(n))}),a()()}if(t&2){let e=r.$implicit,i=v(1);o(4),f(e.preferences.npc?4:-1),o(),f(e.preferences.mapKey==="ci_universal"?5:-1),o(),N("down",!i.isOpen())("translate-y-[-3px]",i.isOpen())("up",i.isOpen()),o(),s("preferences",e.preferences)}}function le(t,r){if(t&1&&(p(0,"app-card",2),k(1,ce,8,9,"app-expandable",5,P),a()),t&2){let e=c();o(),$(e.filteredAndSortedNpcs())}}var Ve=(()=>{class t extends q{#e;#t;#o;#i;#n;constructor(){super(),this.npcFilter=S(g),this.uiIcon=Q,this.#e=C(()=>this.npcFilter()?.searchValueChanges()??""),this.#t=C(()=>this.npcFilter()?.sortValueChanges()??"default"),this.#o=z,this.#i=F(void 0),this.filteredAndSortedNpcs=C(()=>{let e=this.#i()??[];if(!this.#e||!this.#t)return e;let i=this.#e().toLowerCase(),n=this.#t();return this.#o(e,i,n)}),this.#n=E(U),this.gifting$=G({gifts:this.#n.fetchGiftingPreferences$(),npcs:this.#n.fetchNPCs$()}).pipe(T(({gifts:e,npcs:i})=>{let n=e.map(l=>({preferences:l,npc:i.find(te=>te.key===l.mapKey)}));return this.#i?.set(n),b(n)}))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=D({type:t,selectors:[["app-gifting"]],viewQuery:function(i,n){i&1&&O(n.npcFilter,g,5),i&2&&L()},features:[V],decls:5,vars:4,consts:[["expandableComponent",""],["listDetail","",3,"item"],[1,"text-xl"],["appDatabaseItemDetails",""],[3,"details"],["open","",1,"mb-8"],["expandableHeader","",1,"flex","justify-between","items-center","cursor-pointer",3,"click"],[1,"text-2xl","text-black","font-semibold","flex","items-center","gifting-portrait"],[1,"arrow"],[3,"itemClicked","preferences"],[1,"h-16","mr-3",3,"itemName"],[1,"flex","flex-col"],[1,"flex","gap-2","items-center"],[1,"!text-gifting","!h-6","!w-6",3,"uiIcon","matTooltip"],[1,"text-lg","flex","gap-2"],[1,"!h-6","!w-6",3,"uiIcon"]],template:function(i,n){if(i&1&&(p(0,"app-list-detail-container"),m(1,ne,2,1,"app-item-card-switch",1),d(2,"app-npc-filter"),m(3,le,3,0,"app-card",2),w(4,"async"),a()),i&2){let l;o(),f(n.selectedEntity?1:-1),o(2),f((l=I(4,2,n.gifting$))?3:-1,l)}},dependencies:[W,H,Y,X,K,Z,j,ee,J,R,M,g],styles:[`.gifting-portrait .app-item-icon>img{width:auto;height:100%;aspect-ratio:unset}
`],encapsulation:2})}}return t})();export{Ve as GiftingComponent};
