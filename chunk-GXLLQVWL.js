import{a as V,b as z}from"./chunk-WQWM5V3T.js";import{a as Z}from"./chunk-OAUMTRPI.js";import{a as Q}from"./chunk-5C6YMBLV.js";import{a as U}from"./chunk-K77R4BJS.js";import"./chunk-KBJACSGS.js";import{a as K}from"./chunk-VXQBK2DC.js";import"./chunk-XZWLFQMH.js";import"./chunk-XSV5HIP5.js";import"./chunk-VJUOC7OS.js";import{a as O,c as X}from"./chunk-IN7U4HAH.js";import"./chunk-EIGW5THG.js";import"./chunk-FKRWSLGD.js";import{a as Y}from"./chunk-37KGVQVA.js";import"./chunk-5YOBLJC2.js";import{b as q}from"./chunk-4RPGNDDY.js";import"./chunk-O3BKA2PM.js";import"./chunk-U7G2FOHA.js";import"./chunk-H3WVOQZP.js";import{b as H}from"./chunk-EV4S2XUE.js";import"./chunk-NXARORLY.js";import"./chunk-BO7LODCH.js";import{i as G,l as f}from"./chunk-VA7RNGDO.js";import"./chunk-IIRYQ5NI.js";import"./chunk-HU7WFQWJ.js";import"./chunk-JCTEBOW5.js";import{c as M}from"./chunk-SJRCRC22.js";import"./chunk-JL222CZ7.js";import"./chunk-YRO5LM32.js";import"./chunk-TIIEJEUC.js";import"./chunk-PS3FMX3M.js";import{g as L,j as E}from"./chunk-7JOAVXDE.js";import"./chunk-KLZCJ54W.js";import"./chunk-PYPF6S35.js";import"./chunk-FJWSANLQ.js";import{Ba as N,Hc as j,Ic as B,Jb as o,Lb as J,Pb as h,Rb as y,Sb as S,Tb as F,Ub as l,Vb as p,Wb as d,Yc as k,_b as I,ac as v,bc as r,db as c,kd as A,ma as x,na as D,sb as u,wb as $,xc as P,yc as R,zb as _,zc as W}from"./chunk-J7WD3OMO.js";import"./chunk-4CLCTAJ7.js";function nt(e,a){if(e&1&&d(0,"app-fish",2),e&2){let t=r().$implicit;o("fish",t.fish)}}function at(e,a){if(e&1&&d(0,"app-insect",3),e&2){let t=r().$implicit;o("critter",t.insect)}}function ot(e,a){if(e&1&&d(0,"app-insect",3),e&2){let t=r().$implicit;o("critter",t.oceanCritter)}}function rt(e,a){if(e&1&&_(0,nt,1,1,"app-fish",2)(1,at,1,1,"app-insect",3)(2,ot,1,1,"app-insect",3),e&2){let t=a.$implicit;h(t.fish?0:t.insect?1:t.oceanCritter?2:-1)}}var tt=(()=>{class e{constructor(){this.critter=N.required(),k(()=>{this.critter(),this.#t()})}#t(){let t=this.critter();this.toDoContext="fishName"in t?"journal_fish":t.item.inventoryCategory.toLocaleLowerCase()==="bug"?"journal_insects":"journal_critter"}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=u({type:e,selectors:[["app-caught-details"]],inputs:{critter:[1,"critter"]},decls:2,vars:2,consts:[[3,"context","itemId"],["appDatabaseItemDetails",""],[3,"fish"],[3,"critter"]],template:function(i,n){i&1&&(l(0,"app-database-item-details",0),_(1,rt,3,1,"ng-template",1),p()),i&2&&o("context",n.toDoContext)("itemId",n.critter().item.id)},dependencies:[V,z,K,Q],encapsulation:2})}}return e})();function st(e,a){if(e&1&&d(0,"app-caught-details",1),e&2){let t=r();o("critter",t.selectedEntity)}}function lt(e,a){if(e&1){let t=I();l(0,"app-item-icon",8),v("click",function(){let n=x(t).$implicit,m=r(4);return D(m.showDetails(n))}),p()}if(e&2){let t=a.$implicit,i=r(4);J("selected-icon",(i.selectedEntity==null||i.selectedEntity.item==null?null:i.selectedEntity.item.id)===t.item.id),o("itemName",t.item.iconName)}}function ct(e,a){if(e&1&&(l(0,"div",5),S(1,lt,1,3,"app-item-icon",7,y),p()),e&2){let t=r();c(),F(t)}}function pt(e,a){if(e&1&&d(0,"app-caught-table",6),e&2){let t=r();o("dataSource",t)}}function mt(e,a){if(e&1){let t=I();l(0,"app-data-filter",4),W("showTableChange",function(n){x(t);let m=r(2);return R(m.showTable,n)||(m.showTable=n),D(n)}),p(),_(1,ct,3,0,"div",5)(2,pt,1,1,"app-caught-table",6)}if(e&2){let t=r(2);P("showTable",t.showTable),o("parentFormGroup",t.formControl)("locations",t.getLocations(a)),c(),h(t.showTable?-1:1),c(),h(t.showTable?2:-1)}}function _t(e,a){if(e&1&&(l(0,"mat-tab",3),_(1,mt,3,5),j(2,"async"),p()),e&2){let t,i=a.$implicit;o("label",i.title),c(),h((t=B(2,2,i.data))?1:-1,t)}}var Jt=(()=>{class e extends U{constructor(){super(new G({season:new f([...L],{nonNullable:!0}),weather:new f([...E],{nonNullable:!0}),location:new f(null)})),this.SEA_CRITTERS_INDEX=2,this.tabs=[{title:"Fish",data:this.getFilteredJournalData(this._database.fetchJournalOrder$("journal-fish"),this._database.fetchFish$(),0)},{title:"Insects",data:this.getFilteredJournalData(this._database.fetchJournalOrder$("journal-insects"),this._database.fetchBugsAndInsects$(),1)},{title:"Sea Critters",data:this.getFilteredJournalData(this._database.fetchJournalOrder$("journal-sea-critters"),this._database.fetchOceanCritters$(),this.SEA_CRITTERS_INDEX)}],this.activateTabFromRoute(this.tabs.map(t=>t.title))}filterPredicate(t,i,n){if(!i.season?.length||!i.weather?.length)return!1;let m="spawnSettings"in t?t.spawnSettings?.map(s=>s.spawnSeason):[t.spawnSeason],g="spawnSettings"in t?t.spawnSettings?.map(s=>s.spawnWeather):[t.spawnWeather],et="spawnSettings"in t?t.spawnSettings?.map(s=>s.spawnLocation).flat():t.spawnLocation;return!(!i.location||et.includes(i.location))||!m.reduce((s,w)=>{let C=M(w).toLowerCase(),b=C==="any"||i.season?.length===L.length||!!i.season?.some(T=>C.includes((""+T).toLowerCase()));return s||b},!1)?!1:g.reduce((s,w)=>{let C=M(w).toLowerCase(),b=n===this.SEA_CRITTERS_INDEX||C==="any"||i.weather?.length===E.length||!!i.weather?.some(T=>C.includes((""+T).toLowerCase()));return s||b},!1)}getLocations(t){return t.length?[...new Set(t.map(i=>"fishName"in i?i.spawnSettings.map(n=>n.spawnLocation):i.spawnLocation).flat(2))].sort():[]}resetLocationFilter(){this.formControl.get("location")?.setValue(null)}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=u({type:e,selectors:[["app-caught"]],features:[$],decls:5,vars:3,consts:[[3,"removePlaceholder"],["listDetail","",3,"critter"],[3,"selectedTabChange","selectedIndex"],[3,"label"],[3,"showTableChange","showTable","parentFormGroup","locations"],[1,"icon-grid"],[3,"dataSource"],[1,"icon-grid-item",3,"itemName","selected-icon"],[1,"icon-grid-item",3,"click","itemName"]],template:function(i,n){i&1&&(l(0,"app-list-detail-container",0),_(1,st,1,1,"app-caught-details",1),l(2,"mat-tab-group",2),v("selectedTabChange",function(g){return n.updateUrl(g),n.resetLocationFilter()}),S(3,_t,3,4,"mat-tab",3,y),p()()),i&2&&(o("removePlaceholder",n.showTable),c(),h(n.selectedEntity?1:-1),c(),o("selectedIndex",n.selectedTabIndex()),c(),F(n.tabs))},dependencies:[q,tt,X,O,Y,H,Z,A],encapsulation:2})}}return e})();export{Jt as CaughtComponent};
