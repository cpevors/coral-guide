import{a as g,b as z}from"./chunk-6OJSOW6F.js";import"./chunk-DJJM56ZO.js";import{a as W}from"./chunk-ASRLPB3X.js";import{a as X,b as Z}from"./chunk-4ABN5UX5.js";import"./chunk-J5YIE2TK.js";import"./chunk-7R6UEU2W.js";import{a as ee}from"./chunk-VSL7YAPH.js";import"./chunk-24FAZNX7.js";import{a as Y}from"./chunk-Z5UBBEAD.js";import"./chunk-EKZGRJW6.js";import"./chunk-CXV365G5.js";import"./chunk-WQWM5V3T.js";import"./chunk-FGYBINTK.js";import"./chunk-OBPRYC72.js";import"./chunk-EKOP5NP3.js";import"./chunk-N2KJDITY.js";import"./chunk-NGYDMITL.js";import"./chunk-YQVLGDGS.js";import"./chunk-6Q5ZQTY6.js";import"./chunk-5C6YMBLV.js";import"./chunk-VXQBK2DC.js";import"./chunk-XZWLFQMH.js";import"./chunk-XSV5HIP5.js";import"./chunk-VJUOC7OS.js";import"./chunk-EIGW5THG.js";import"./chunk-FKRWSLGD.js";import"./chunk-5YOBLJC2.js";import{b as K,c as q}from"./chunk-4RPGNDDY.js";import"./chunk-O3BKA2PM.js";import{a as J}from"./chunk-U7G2FOHA.js";import{b as R}from"./chunk-EV4S2XUE.js";import"./chunk-NXARORLY.js";import"./chunk-BO7LODCH.js";import"./chunk-VA7RNGDO.js";import"./chunk-IIRYQ5NI.js";import"./chunk-HU7WFQWJ.js";import{b as U}from"./chunk-JCTEBOW5.js";import"./chunk-SJRCRC22.js";import{a as H}from"./chunk-JL222CZ7.js";import"./chunk-YRO5LM32.js";import{a as j}from"./chunk-TIIEJEUC.js";import"./chunk-PS3FMX3M.js";import{b as Q}from"./chunk-7JOAVXDE.js";import"./chunk-KLZCJ54W.js";import"./chunk-PYPF6S35.js";import"./chunk-FJWSANLQ.js";import{Fa as F,Hc as w,Ic as I,Jb as s,Lb as N,Pb as f,Rb as P,Sb as k,Tb as $,U as T,Ub as p,Vb as a,Vc as C,Wb as d,_b as A,ac as h,bc as c,db as o,ea as E,fc as B,k as b,kd as M,lb as S,ma as u,na as x,oc as O,pc as L,qc as v,sb as D,sc as _,uc as y,v as G,wb as V,zb as m}from"./chunk-J7WD3OMO.js";import"./chunk-4CLCTAJ7.js";function ie(t,r){if(t&1&&d(0,"app-offering",4),t&2){let e=r.$implicit;s("details",e)}}function ne(t,r){if(t&1&&(p(0,"app-item-card-switch",1),m(1,ie,1,1,"ng-template",3),a()),t&2){let e=c();s("item",e.selectedEntity)}}function oe(t,r){if(t&1&&d(0,"app-ui-icon",13),t&2){let e=c(2).$implicit,i=c(2);B("matTooltip","",e.npc==null?null:e.npc.characterName," is dateable"),s("uiIcon",i.uiIcon.LOVE)}}function ae(t,r){if(t&1&&(p(0,"div",14),d(1,"app-ui-icon",15),_(2),w(3,"ingameDate"),a()),t&2){let e=c(2).$implicit,i=c(2);o(),s("uiIcon",i.uiIcon.BIRTHDAY),o(),y(" ",I(3,2,e.npc.birthday)," ")}}function re(t,r){if(t&1&&(d(0,"app-item-icon",10),p(1,"div",11)(2,"div",12),_(3),m(4,oe,1,3,"app-ui-icon",13),a(),m(5,ae,4,4,"div",14),a()),t&2){let e=c().$implicit;s("itemName",e.preferences.npc.iconName),o(3),y(" ",e.preferences.npc.characterName," "),o(),f(e.npc!=null&&e.npc.isDateable?4:-1),o(),f(e.npc&&e.npc.birthday?5:-1)}}function pe(t,r){t&1&&_(0," Universal ")}function ce(t,r){if(t&1){let e=A();p(0,"app-expandable",5,0)(2,"div",6),h("click",function(){u(e);let n=v(1);return x(n.toggle())}),p(3,"div",7),m(4,re,6,4)(5,pe,1,0),a(),d(6,"i",8),a(),p(7,"app-gifting-grid",9),h("itemClicked",function(n){u(e);let l=c(2);return x(l.showDetails(n))}),a()()}if(t&2){let e=r.$implicit,i=v(1);o(4),f(e.preferences.npc?4:-1),o(),f(e.preferences.mapKey==="ci_universal"?5:-1),o(),N("down",!i.isOpen())("translate-y-[-3px]",i.isOpen())("up",i.isOpen()),o(),s("preferences",e.preferences)}}function le(t,r){if(t&1&&(p(0,"app-card",2),k(1,ce,8,9,"app-expandable",5,P),a()),t&2){let e=c();o(),$(e.filteredAndSortedNpcs())}}var Ve=(()=>{class t extends q{#e;#t;#o;#i;#n;constructor(){super(),this.npcFilter=S(g),this.uiIcon=Q,this.#e=C(()=>this.npcFilter()?.searchValueChanges()??""),this.#t=C(()=>this.npcFilter()?.sortValueChanges()??"default"),this.#o=z,this.#i=F(void 0),this.filteredAndSortedNpcs=C(()=>{let e=this.#i()??[];if(!this.#e||!this.#t)return e;let i=this.#e().toLowerCase(),n=this.#t();return this.#o(e,i,n)}),this.#n=E(U),this.gifting$=G({gifts:this.#n.fetchGiftingPreferences$(),npcs:this.#n.fetchNPCs$()}).pipe(T(({gifts:e,npcs:i})=>{let n=e.map(l=>({preferences:l,npc:i.find(te=>te.key===l.mapKey)}));return this.#i?.set(n),b(n)}))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=D({type:t,selectors:[["app-gifting"]],viewQuery:function(i,n){i&1&&O(n.npcFilter,g,5),i&2&&L()},features:[V],decls:5,vars:4,consts:[["expandableComponent",""],["listDetail","",3,"item"],[1,"text-xl"],["appDatabaseItemDetails",""],[3,"details"],["open","",1,"mb-8"],["expandableHeader","",1,"flex","justify-between","items-center","cursor-pointer",3,"click"],[1,"text-2xl","text-black","font-semibold","flex","items-center","gifting-portrait"],[1,"arrow"],[3,"itemClicked","preferences"],[1,"h-16","mr-3",3,"itemName"],[1,"flex","flex-col"],[1,"flex","gap-2","items-center"],[1,"!text-gifting","!h-6","!w-6",3,"uiIcon","matTooltip"],[1,"text-lg","flex","gap-2"],[1,"!h-6","!w-6",3,"uiIcon"]],template:function(i,n){if(i&1&&(p(0,"app-list-detail-container"),m(1,ne,2,1,"app-item-card-switch",1),d(2,"app-npc-filter"),m(3,le,3,0,"app-card",2),w(4,"async"),a()),i&2){let l;o(),f(n.selectedEntity?1:-1),o(2),f((l=I(4,2,n.gifting$))?3:-1,l)}},dependencies:[W,H,Y,X,K,Z,j,ee,J,R,M,g],styles:[`.gifting-portrait .app-item-icon>img{width:auto;height:100%;aspect-ratio:unset}
`],encapsulation:2})}}return t})();export{Ve as GiftingComponent};
